<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Chess</title>
        <link rel="icon" href="/public/favicon.ico" sizes="32x32" type="image/x-icon">
        <style>
            .black {
                background-color: gray;
            }
            .white {
                background-color: white;
            }
            .chessboard {
                border: 2px solid black;
                display: grid;
                grid-template-columns: repeat(8, 50px);
                grid-template-rows: repeat(8, 50px);
                width: 400px;
                height: 400px;
            }
            .holding {
                cursor: grabbing;
                background-color: yellow;
            }
            .tile {
                align-items: center;
                color: black;
                display: flex;
                font-size: 2.5rem;
                justify-content: center;
                width: 50px;
                height: 50px;
            }
        </style>
    </head>
    <body>
        <h1>Chess</h1>
        <div class="chessboard" id="chessboard">
            <% data.forEach((row, rowIndex) => { %>
                <% row.forEach((piece, colIndex) => { %>
                    <div class="tile <%= (rowIndex + colIndex) % 2 === 0 ? 'white' : 'black' %>" 
                         data-row="<%= rowIndex %>" data-col="<%= colIndex %>">
                        <%= piece %>
                    </div>
                <% }) %>
            <% }) %>
        </div>
        <script>
            let holdingPiece = null;
    
            document.addEventListener('DOMContentLoaded', () => {
                const chessboard = document.getElementById('chessboard');
    
                // Event listeners for each tile
                chessboard.addEventListener('click', (event) => {
                    const tile = event.target.closest('.tile');
    
                    if (!tile) return;
    
                    if (!holdingPiece && tile.textContent.trim()) {
                        // Start holding a piece
                        holdingPiece = tile.textContent;
                        tile.textContent = '';
                        tile.classList.add('holding');
                    }
                    
                    else if (holdingPiece) {
                        // Drop the piece into the clicked tile
                        tile.textContent = holdingPiece;
                        holdingPiece = null;
                        document.querySelectorAll('.tile').forEach(t => t.classList.remove('holding'));
                    }
                });
            });
        </script>
    </body>
</html>
